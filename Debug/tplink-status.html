<script language=JavaScript>
var statusPara = new Array(
2,
0,
16,
20000,
152,
"4.0.1 Build 080909 Rel.52917n ",
"WA500G v2/WA501G v1 081520C2",
0,0 );
</script>
<script language=JavaScript>
var lanPara = new Array(
"00-23-CD-CC-64-D3", "192.168.0.254", "255.255.255.0", 
0,0 );
</script>
<script language=JavaScript>
var wlanPara = new Array(
5,
"HG520s",
1,
2,
"00-23-CD-CC-64-D3",
"192.168.0.254",
0,
5,
"10 dB",
0,0 );
</script>
<script language=JavaScript>
var statistList = new Array(
1173528, 236492, 1595, 1428, 
0,0 );
</script>
<script language=JavaScript>
var wanPara = new Array(
0, "00-23-CD-CC-64-D3", "0.0.0.0", 1, "0.0.0.0", 0, 0, "0.0.0.0", 2, 1, 0, "0.0.0.0 , 0.0.0.0", "", 0, 
0,0 );
</script>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="expires" content="wed, 26 Feb 1997 08:21:57 GMT">
<LINK href="/dynaform/css_main.css" rel=stylesheet>
<script language="JavaScript" src="/dynaform/common.js" type="text/JavaScript"></script>
<script language="JavaScript"><!--
if(window.parent == window){window.location.href="http://192.168.0.254";}
function Click(){ window.event.returnValue=false;}
document.oncontextmenu=Click;
//--></script>

<script language=javascript><!--//
function doRefresh(){location.href="StatusRpm.htm"; return true;}
function doConnect(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?Connect=Connect"+s;return true;
}
function doDisConnect(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?Disconnect=Disconnect"+s;return true;
}
function doRenew(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?RenewIp=Renew"+s;return true;
}
function doRelease(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?ReleaseIp=Release"+s;return true;
}
function doLogin(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?Login=Login"+s;return true;
}
function doLogout(n){
var s = "&wan="+n;
location.href="StatusRpm.htm?Logout=Logout"+s;return true;
}
var wanTypeStringArray = new Array(
" ",
"<span id = \"t_dyn_ip\">Dynamic IP</span>",
"<span id =\"t_static_ip\">Static IP</span>",
"PPPoE",
"<span id = \"t_ie_dyn\">IEEE802.1X + Dynamic IP</span>" ,
"<span id = \"t_ie_static\">IEEE802.1X + Static IP</span>",
"<span id = \"t_big_pond_cable\">Big Pond Cable</span>",
"L2TP",
"PPTP"
);
var wanStatusStringArray = new Array(
" ",
"<span id = \"t_disabled\">Disabled</span>",
"<span id = \"t_timeout\">Timeout</span>",
"<span id = \"t_link_down\">Link Down</span>",
"<span id = \"t_link_up\">Link Up</span>"
);
var wlanTypeStringArray = new Array(
" ",
"11Mbps (802.11b)",
"54Mbps (802.11g)",
"<span id=\"t_sta\">108Mbps (Static)</span>",
"<span id=\"t_dyn\">108Mbps (Dynamic)</span>",
" "
);
var IEEE8021xLoginStringArray = new Array(
" ",
"<span id = \"t_not_log_in\">Not log in</span>"	,
"<span id = \"t_logging_in\">Logging in, please wait...</span>"	,
"<span id = \"t_longin_successfully\">Login successfully</span>"
);
var DHCPStringArray = new Array(
" ",
"<span id = \"t_obtaining_net_paramenter\">Obtaining network parameters...</span>"
);
var maskArray = new Array(
"255.0.0.0",
"255.255.0.0",
"255.255.255.0"
);
var wlanChannelWidthArray = new Array(
"",
"20M",
"Auto",
"40M"
);
--></script></head>
<BODY onload="LoadHelp('StatusHelpRpm.htm');setTagStr(document,'ntw_status'); resize(this);" onResize="resize(this);">
<center><form action="StatusRpm.htm" enctype="multipart/form-data" method="get">
<TABLE id="autoWidth">
<TBODY>
<TR><TD class=h1 colspan=3 id = "t_title">Status</TD></TR>
<TR><TD class=blue colspan=3></TD></TR>
<TR><TD class=Item id = "t_firm_vs">Firmware Version:</TD><TD colspan=2><DIV ID="fversion"></DIV></TD></TR>
<TR><TD class=Item id = "t_hd_vs">Hardware Version:</TD><TD colspan=2><DIV ID="hversion"></DIV></TD></TR>
<TR><TD class=blue colspan=3></TD></TR>
<script language="JavaScript">
if(statusPara[1]!=0){document.write('<TR><TD class=h2 colspan=3 id = "t_lan">LAN</TD></TR>');}
else{document.write('<TR><TD class=h2 colspan=3 id = "t_wired">Wired</TD></TR>');}
</script>
<TR><TD width=25% class=Item id = "t_mac_addr">MAC Address:</TD><TD colspan=2><DIV ID="lanMac">-</DIV></TD></TR>

<TR><TD class=Item id = "t_ip_addr">IP Address:</TD><TD colspan=2 ><DIV ID="lanIP">-</DIV></TD></TR>
<TR><TD class=Item id = "t_sub_mask">Subnet Mask:</TD><TD colspan=2 ><DIV ID="lanMask">-</DIV></TD></TR>
<TR><TD class=blue colspan=3></TD></TR>
<script language="JavaScript"><!--
var apModeName = new Array(
"<span id=\"t_node_disable\">Disabled</span>",
"<span id=\"t_acc_point\">Access Point</span>",
"<span id=\"t_client1\">Client</span>",
"<span id=\"t_client2\">Client</span>",
"<span id=\"t_repeater\">Repeater</span>",
"<span id=\"t_unRepeater\">Universal Repeater</span>",
"<span id=\"t_bridge_p2p\">Bridge (Point to Point)</span>",
"<span id=\"t_bridge_p2m\">Bridge (Point to Multi-Point)</span>",
0, 0
);
var maskType = lanPara[2];
if (statusPara[0] >= 1)
{
var wlanMode = apModeName[wlanPara[0]];
var wlanSta = (wlanPara[0] == 0)?"<span id = \"t_disable\">Disable</span>":"<span id = \"t_enable\">Enable</span>" ;
var wlanName =wlanPara[1];
while(wlanName.indexOf(" ")!=-1)
{
	wlanName = wlanName.replace(" ", "&nbsp;");
}
var wlanChannel=wlanPara[2];
var wlanModeIndex=wlanPara[3];
var wlanMac=wlanPara[4];
var wlanIp=wlanPara[5];
var wlanRssi=wlanPara[8];
document.write('<TR><TD class=h2 colspan=3 id = "t_wireless">Wireless</TD></TR>');
if ((statusPara[0] == 2) && (wlanPara[0] > 0)){
document.write('<TR><TD class=Item id="t_mode1">Operating Mode:</TD><TD colspan=2>' + wlanMode +'</TD></TR>');
}
else{
document.write('<TR><TD class=Item id = "t_wireless_radio">Wireless Radio:</TD><TD colspan=2>' + wlanSta +'</TD></TR>');
}
if (wlanPara[0] >= 2){
document.write('<TR><TD class=Item id="t_signal">Signal:</TD><TD colspan=2>' + wlanRssi +'</TD></TR>');
}
if ((wlanPara[0] == 1) || (wlanPara[0] == 2) || (wlanPara[0] == 4) || (wlanPara[0] == 5)){
document.write('<TR><TD class=Item>SSID:</TD><TD colspan=2>' + wlanName +'</TD></TR>');
}
else if (wlanPara[0] > 0){
document.write('<TR><TD class=Item id="t_remoteMAC">Remote MAC:</TD><TD colspan=2>' + wlanName +'</TD></TR>');
}
document.write('<TR><TD class=Item id = "t_channel">Channel:</TD><TD colspan=2>' + wlanChannel +'</TD></TR>');
if (wlanPara[7]!=7){
document.write('<TR><TD class=Item id = "t_mode">Mode:</TD><TD colspan=2>' + wlanTypeStringArray[wlanModeIndex] +'</TD></TR>');
}
	document.write('<TR><TD class=Item id = "t_mac_addr2">MAC Address:</TD><TD colspan=2>' + wlanMac +'</TD></TR>');
	document.write('<TR><TD class=Item id = "t_ip_addr2">IP Address:</TD><TD colspan=2>' + wlanIp +'</TD></TR>');
	document.write('<TR><TD class=blue colspan=3></TD></TR>');
}

/* --------------------------------------------------------------------------------------------------------------------  */
var row = 0;
var wanStatusIndex;
var wanTypeIndex;
var IEEE8021xStatusIndex;
var DHCPBtnStatus;
var DHCPStatusIndex;
for (var i=1; i<=statusPara[1]; i++)
{
	row = (i-1) * statusPara[2];
	
	if (statusPara[1] == 1)
	{
		document.write('<TR><TD class=h2 colspan=3 id = "t_wan1">WAN</TD></TR>');
	}
	else
	{
		wanStatusIndex = wanPara[row];
		document.write('<TR><TD class=h2 colspan=3>WAN'+ i +'</TD></TR>');
		document.write('<TR><TD class=Item id = "t_status">Status:</TD><TD colspan=2>' +
		wanStatusStringArray[wanStatusIndex] +'</TD></TR>');
	}
	
	document.write('<TR><TD class=Item id = "t_mac_addr1" name = "t_mac_addr1">MAC Address:</TD><TD colspan=2>' + wanPara[row+1] +'</TD></TR>');
	wanTypeIndex = wanPara[row+3];
	document.write('<TR><TD class=Item id = "t_ip_addr1" name = "t_ip_addr1">IP Address:</TD><TD>' + wanPara[row+2] +'</TD><TD>' + wanTypeStringArray[wanTypeIndex] +'</TD></TR>');
	document.write('<TR><TD class=Item id = "t_sub_mask1" name = "t_sub_mask1">Subnet Mask:</TD><TD>' + wanPara[row+4] +'</TD>');
	
	IEEE8021xStatusIndex = wanPara[row+6];
	if (wanPara[row+5] == 1)
	{
		document.write('<TD class=emp><input name=Logout type=button class=button value=Logout onClick="return doLogout(' + i +');">&nbsp;&nbsp;' + IEEE8021xLoginStringArray[IEEE8021xStatusIndex] +'</TD></TR>');
	}
	else if(wanPara[row+5] == 2)
	{
		document.write('<TD class=emp><input name=Login type=button class=button value=Login onClick="return doLogin(' + i +');">&nbsp;&nbsp;' + IEEE8021xLoginStringArray[IEEE8021xStatusIndex] +'</TD></TR>');
	}
	else
	{
		document.write('<TD>&nbsp;</TD></TR>');
	}
	
	document.write('<TR><TD class=Item id = "t_def_gt" name = "t_def_gt">Default Gateway:</TD><TD>' + wanPara[row+7] +'</TD>');
	DHCPBtnStatus = (wanPara[row+9] == 0)?"disabled":" ";
	DHCPStatusIndex = wanPara[row+10];
	if (wanPara[row+8] == 1)
	{
		document.write('<TD class=emp><input name="ReleaseIP" type=button class=button value="Release" onClick="return doRelease(' + i +');" ' + DHCPBtnStatus +'>&nbsp;&nbsp;' + DHCPStringArray[DHCPStatusIndex] +'</TD></TR>');
	}
	else if 	(wanPara[row+8] == 2)
	{
		document.write('<TD class=emp><input name="RenewIP" type=button class=button value="Renew" onClick="return doRenew(' + i +');" ' + DHCPBtnStatus +'>&nbsp;&nbsp;' + DHCPStringArray[DHCPStatusIndex] +'</TD></TR>');
	}
	else
	{
		document.write('<TD>&nbsp;</TD></TR>');
	}
	document.write('<TR><TD class=Item id = "t_ddns_ser">DNS Server:</TD><TD colspan=2>' + wanPara[row+11] +'</TD></TR>');
	if(3==wanTypeIndex || 6==wanTypeIndex || 7==wanTypeIndex || 8==wanTypeIndex)
	{
		var pre = /\d+/;
		var front=pre.exec(wanPara[row+12]);
		var back = /\D\d+\S+/;
		var end=back.exec(wanPara[row+12]);
		//document.write('<TR><TD class=Item id = "t_online_time">Online Time:</TD><TD>' + wanPara[row+12] +'</TD>');
		document.write('<TR><TD class=Item id = "t_online_time">Online Time:</TD><TD>' + front + '<span id="t_days">&nbsp;day(s)</span>'+ end +'</TD>');
		if (wanPara[row+13] == 0)
			document.write('<TD><input name=Connect type=button class=button id=Connect value=Connect onClick="return doConnect(' + i +');" ></TD></TR>');
		else if(wanPara[row+13] == 1)
			document.write('<TD><input name=Disconnect type=button class=button id=Disconnect value=Disconnect onClick="return doDisConnect(' + i +');" ></TD></TR>');
		else if (wanPara[row+13] == 2)
			document.write('<TD class=emp id="t_connecting">Connecting...</TD></TR>');
	}
	document.write('<TR><TD class=blue colspan=3></TD></TR>');
}
--></script>

<!-- ******************************************************************************************** -->
<TR><TD class=h2 colspan=3 id = "t_trff_stat">Traffic Statistics</TD></TR>
<TR><TD colspan=3>
<table border=0>
<script language="JavaScript"><!--
if (statusPara[1] == 1 || statusPara[1] == 0)
{
	document.write('<TR><TD width=30%></TD><TD class=ListTC2 width=30% id = "t_received">Received</TD><TD class=ListTC2 id = "t_sent">Sent</TD></TR>');
	document.write('<TR><TD class=Item id = "t_byt">Bytes:</TD><TD class=ListC2>' + statistList[0] + '</TD><TD class=ListC2>' + statistList[1] + '</TD></TR>');
	document.write('<TR><TD class=Item id = "t_pcks">Packets:</TD><TD class=ListC2>' + statistList[2] + '</TD><TD class=ListC2>' + statistList[3] + '</TD></TR>');
}
else
{
	document.write('<tr><td>&nbsp;</td><td class = ListTC2 id = "t_rate" >Rate</td><td class=ListTC2 id = "t_rece_byt">Received (Bytes)</td><td class=ListTC2>Sent (Bytes)</td><td class=ListTC2 id = "t_rece_pck">Received (Packets)</td><td class=ListTC2 id = "t_sent_pcks">Sent (Packets)</td></tr>');
	var total1=0;
	var total2=0;
	var total3=0;
	var total4=0;
	for (var i=0; i<statusPara[1]; i++)	
	{
		total1 = total1 + statistList[i*4];
		total2 = total2 + statistList[i*4+1];
		total3 = total3 + statistList[i*4+2];
		total4 = total4 + statistList[i*4+3];
	}
	document.write('<tr><td class=Item id = "t_total">Total</td><td class=ListC2>' + total1 + '</td><td class=ListC2>' + total2 + '</td><td class=ListC2>' + total3 + '</td>' +'<td class=ListC2>'+ total4 +'</td></tr>');
	for (var i=1; i<=statusPara[1]; i++)
		document.write('<tr><td class=Item>WAN'+i + '</td><td class=ListC2>' + statistList[i*4-4] + '</td><td class=ListC2>' + statistList[i*4-3] + '</td><td class=ListC2>' + statistList[i*4-2] + '</td> '+ '<td class=ListC2>' + statistList[i*4-1] + '</td></tr>');
}
--></script>

</table></TD></TR>

<!-- ******************************************************************************************** -->
<TR><TD class=blue colspan=3></TD></TR>
<TR><TD class=Item id = "t_sys_up_time">System Up Time:</TD><TD><DIV ID="activeTime">-</DIV></TD><TD><input name="Refresh" class="button" type="button" id="Refresh" value="Refresh" onClick="return doRefresh();"></TD></TR>
</TBODY></TABLE>
</form></center></BODY></HTML>

<!-- ******************************************************************************************** -->
<script language="JavaScript"><!--
var timeout = statusPara[3];
window.setTimeout("doRefresh()",timeout);
var unDays		= parseInt(statusPara[4]/(24*60*60),10);
var unHours 	= parseInt((statusPara[4]%(24*60*60))/(60*60),10);
var unMinutes	= parseInt(((statusPara[4]%(24*60*60))%(60*60))/60,10);
var unSeconds 	= ((statusPara[4]%(24*60*60))%(60*60))%60;
unHours = (unHours < 10)?("0"+unHours):unHours;
unMinutes = (unMinutes < 10)?("0"+unMinutes):unMinutes;
unSeconds = (unSeconds < 10)?("0"+unSeconds):unSeconds;
var upTime = unDays+" " + "<span id = \"t_day\"> day(s) </span>"+unHours+":"+unMinutes+":"+unSeconds;
document.getElementById("activeTime").innerHTML = upTime;
document.getElementById("fversion").innerHTML = statusPara[5];
document.getElementById("hversion").innerHTML = statusPara[6];
document.getElementById("lanMac").innerHTML = lanPara[0];
document.getElementById("lanIP").innerHTML = lanPara[1];
document.getElementById("lanMask").innerHTML = lanPara[2];
--></script>
