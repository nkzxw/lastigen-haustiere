<script language=JavaScript>
var apModePara = new Array(
4, "111111111", 1, 0, "", "", "", "00-1B-9E-CE-4B-BC", "", "", "", "", "", "", "", 0, 0, 0, 0, 
0,0 );
</script>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="expires" content="wed, 26 Feb 1997 08:21:57 GMT">
<LINK href="/dynaform/css_main.css" rel=stylesheet>
<script language="JavaScript" src="/dynaform/common.js" type="text/JavaScript"></script>
<script language="JavaScript"><!--
if(window.parent == window){window.location.href="http://192.168.0.254";}
function Click(){ window.event.returnValue=false;}
document.oncontextmenu=Click;
//--></script>
<SCRIPT language="javascript"><!--
var apModeStr = new Array(
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="0" onclick="apModeOnClick(0);">&nbsp;<span id="t_disable">Disable Wireless</span></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="1" onclick="apModeOnClick(1);">&nbsp;<span id="t_access">Access Point</span></TD></TR>' +
	'<TR><td colspan=2 style="padding-left:60px"><input name="apBroadcast" id="apBroadcast" type="checkbox" value="2">&nbsp;<span id="t_enBroadcast">Enable SSID Broadcast</span></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="2" onclick="apModeOnClick(2);"><span id="t_client">Client</span></TD></TR>' +
	'<TR id="chkWds"><td class=item style="padding-left:60px"><input name="staWds" id="staWds" type="checkbox" value="2"><span id="t_enWDS">Enable WDS</span></TD><td>&nbsp</td></TR>' +
	'<TR><td class=item style="padding-left:60px"><input name="staType" id="staType" type="radio" value="0">SSID:</td><TD><input name="staSsid" type="text" class="text" id="staSsid" value="" size="32" maxlength="32"></TD></TR>' +
	'<TR><td class=item><input name="staType" id="staType" type="radio" value="1"><span id="t_macOfAP">MAC of AP:</span></td><TD><input name="staBssid" type="text" class="text" id="staBssid" value="" size="17" maxlength="17"></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="3" onclick="apModeOnClick(3);">&nbsp;<span id="t_repeater">Repeater</span></TD></TR>' +
	'<TR><td class=item style="padding-left:60px"><span id="t_macOfAP1">MAC of AP:</span></td><TD><input id="rptBssid" name="rptBssid" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="4" onclick="apModeOnClick(4);">&nbsp;<span id="t_unRepeater">Universal Repeater</span></TD></TR>' +
	'<TR><td class=item style="padding-left:60px"><span id="t_macOfAP2">MAC of AP:</span></td><TD><input id="urptBssid" name="urptBssid" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="5" onclick="apModeOnClick(5);">&nbsp;<span id="t_bridge">Bridge (Point to Point)</span></TD></TR>' +
	'<TR><TD colspan=2 style="padding-left:60px"><input name="ppt_ap" id="ppt_ap" type="checkbox" value="2">&nbsp;<span id="t_ApMode">With AP Mode</span></TD></TR>' +
	'<TR><td class=item style="padding-left:60px"><span id="t_macOfAP3">MAC of AP:</span></td><TD><input id="pptBssid" name="pptBssid" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
	,
	'<TR><TD colspan = 2 style="padding-left:30px;font-weight:bold;font-size:14px"><input name="apMode" id="apMode" type="radio" value="6" onclick="apModeOnClick(6);">&nbsp;<span id="t_pToMu">Bridge (Point to Multi-Point)</span></TD></TR>' +
	'<TR><TD colspan=2 style="padding-left:60px"><input name="mpt_ap" id="mpt_ap" type="checkbox" value="2">&nbsp;<span id="t_ApMode1">With AP Mode</span></TD></TR>' +
	'<TR><td class=item style="padding-left:60px" nowrap><span id="t_briMacOfAp1">MAC of AP1:</span></td><TD><input id="mptBssid1" name="mptBssid1" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<TR><td class=item><span id="t_briMacOfAp2">MAC of AP2:</span></td><TD><input id="mptBssid2" name="mptBssid2" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<TR><td class=item><span id="t_briMacOfAp3">MAC of AP3:</span></td><TD><input id="mptBssid3" name="mptBssid3" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<TR><td class=item><span id="t_briMacOfAp4">MAC of AP4:</span></td><TD><input id="mptBssid4" name="mptBssid4" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<TR><td class=item><span id="t_briMacOfAp5">MAC of AP5:</span></td><TD><input id="mptBssid5" name="mptBssid5" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<TR><td class=item><span id="t_briMacOfAp6">MAC of AP6:</span></td><TD><input id="mptBssid6" name="mptBssid6" type="text" class="text" value="" size="17" maxlength="17"></TD></TR>' +
	'<tr><td colspan=2><br></td></tr>'
);
function apModeOnClick(i){};
function doSubmit(){
for(var i=0; i<mlist.count; i++){
if (mlist.itemShow(i)){
if (false == mlist.item(i).checkPara()){
return false;
}}}
return true;
}
function CheckMacAddr(macCtrl)
{
if(macCtrl && macCtrl.value != ""){
if(macverify(macCtrl.value)== false){
macCtrl.focus();
macCtrl.select();
return false;
}
return true;
}
return true;
}
function checkSsid(ssidCtrl)
{
if (ssidCtrl){
var ssidLen = getValLen(ssidCtrl.value);
if (ssidLen <= 0){
alert(str_pages.ntw_wlan_mode.js_input_ssid);
ssidCtrl.focus();
ssidCtrl.select();
return false;
}
else if (ssidLen > 32){
alert(str_pages.ntw_wlan_mode.js_bad_ssid);
ssidCtrl.focus();
ssidCtrl.select();
return false;
}
return true;
}
return false;
}
function checkEmpty(ssidCtrl)
{
if (ssidCtrl){
if (ssidCtrl.value == ""){
ssidCtrl.focus();
ssidCtrl.select();
return false;
}
return true;
}
return false;
}

function getValLen(val)
{
var len = 0;
var i = 0;
for (i = 0; i < val.length; i ++){
var c = val.charAt(i);
len += ((c >= ' ') && (c <= '~')) ? 1 : 2;
}
return len;
}
function mode_disable(idx, en, ps)
{
this.setPara = function(){}
this.checkPara = function(){
return true;
}}
function mode_ap(idx, father)
{
this.setPara = function(){
window.document.getElementById("apBroadcast").checked = (father.ps.apBroadcast == 1);
}
this.checkPara = function(){
return true;
}}
function mode_clientWds(idx, father)
{
this.setPara = function(){
window.document.getElementById("staWds").checked = (father.ps.wdsDisabled == 1);
window.document.getElementsByName("staType")[father.ps.staType].checked = true;
window.document.getElementById("staSsid").value = father.ps.staSsid;
window.document.getElementById("staBssid").value = father.ps.staBssid;
}
this.checkPara = function(){
if (!father.itemShow(idx)){
return true;
}
var typeCtrl = window.document.getElementsByName("staType");
var ssidCtrl = window.document.getElementById("staSsid");
var bssidCtrl = window.document.getElementById("staBssid");
if (father.checkIdx(idx) && typeCtrl[0].checked && !checkSsid(ssidCtrl)){
return false;
}
if (!CheckMacAddr(bssidCtrl)){
return false;
}
if (father.checkIdx(idx) && typeCtrl[1].checked && !checkEmpty(bssidCtrl)){
alert(str_pages.ntw_wlan_mode.js_input_client_mac);
return false;
}
if (father.ps.secType == 2 && father.checkIdx(idx)){
if (!confirm(str_pages.ntw_wlan_mode.js_mksure_disable_security)){
return false;
}
else{
window.document.getElementById("secDisable").checked = true;
}}
return true;
}}
function mode_repeater(idx, father)
{
this.setPara = function(){
window.document.getElementById("rptBssid").value = father.ps.rptBssid;
}
this.checkPara = function(){
if (!father.itemShow(idx)){
return true;
}
var ssidCtrl = window.document.getElementById("rptBssid");
if (father.checkIdx(idx) && !checkEmpty(ssidCtrl)){
alert(str_pages.ntw_wlan_mode.js_input_repeater_mac);
return false;
}
else if (!CheckMacAddr(ssidCtrl)){
return false;
}
if ((father.ps.secType == 2 || father.ps.secType == 3) && father.checkIdx(idx)){
if (!confirm(str_pages.ntw_wlan_mode.js_mksure_disable_security)){
return false;
}
else{
window.document.getElementById("secDisable").checked = true;
}}
return true;
}}
function mode_uRepeater(idx, father)
{
this.setPara = function(){
window.document.getElementById("urptBssid").value = father.ps.urptBssid;
}
this.checkPara = function(){
if (!father.itemShow(idx)){
return true;
}
var ssidCtrl = window.document.getElementById("urptBssid");
if (father.checkIdx(idx) && !checkEmpty(ssidCtrl)){
alert(str_pages.ntw_wlan_mode.js_input_repeater_mac);
return false;
}
else if (!CheckMacAddr(ssidCtrl)){
return false;
}
if ((father.ps.secType == 2 || father.ps.secType == 3) && father.checkIdx(idx)){
if (!confirm(str_pages.ntw_wlan_mode.js_mksure_disable_security)){
return false;
}
else{
window.document.getElementById("secDisable").checked = true;
}}
return true;
}}
function mode_bridge(idx, father)
{
this.setPara = function(){
window.document.getElementById("ppt_ap").checked = (father.ps.pptApMode == 1);
window.document.getElementById("pptBssid").value = father.ps.pptBssid;
}
this.checkPara = function(){
if (!father.itemShow(idx)){
return true;
}
var ssidCtrl = window.document.getElementById("pptBssid");
if (father.checkIdx(idx) && !checkEmpty(ssidCtrl)){
alert(str_pages.ntw_wlan_mode.js_input_bridge_mac);
return false;
}
else if (!CheckMacAddr(ssidCtrl)){
return false;
}
if ((father.ps.secType == 2 || father.ps.secType == 3) && father.checkIdx(idx)){
if (!confirm(str_pages.ntw_wlan_mode.js_mksure_disable_security)){
return false;
}
else{
window.document.getElementById("secDisable").checked = true;
}}		
return true;
}}
function mode_mBridge(idx, father)
{
this.setPara = function(){
window.document.getElementById("mpt_ap").checked = (father.ps.mptApMode == 1);
window.document.getElementById("mptBssid1").value = father.ps.mptBssid1;
window.document.getElementById("mptBssid2").value = father.ps.mptBssid2;
window.document.getElementById("mptBssid3").value = father.ps.mptBssid3;
window.document.getElementById("mptBssid4").value = father.ps.mptBssid4;
window.document.getElementById("mptBssid5").value = father.ps.mptBssid5;
window.document.getElementById("mptBssid6").value = father.ps.mptBssid6;
}
this.checkPara = function(){
if (!father.itemShow(idx)){
return true;
}
var ssidCtrl1 = window.document.getElementById("mptBssid1");
var ssidCtrl2 = window.document.getElementById("mptBssid2");
var ssidCtrl3 = window.document.getElementById("mptBssid3");
var ssidCtrl4 = window.document.getElementById("mptBssid4");
var ssidCtrl5 = window.document.getElementById("mptBssid5");
var ssidCtrl6 = window.document.getElementById("mptBssid6");
var inputNum = 0;
if (ssidCtrl1.value != ""){
if (!CheckMacAddr(ssidCtrl1)){
return false;
}
else{
inputNum ++;
}}
if (ssidCtrl2.value != ""){
if (!CheckMacAddr(ssidCtrl2)){
return false;
}
else if (ssidCtrl2.value.toLowerCase() == ssidCtrl1.value.toLowerCase()){
alert(str_pages.ntw_wlan_mode.js_mac_duplicate);
ssidCtrl2.focus();
ssidCtrl2.select();
return false;
}
else{
inputNum ++;
}}
if (ssidCtrl3.value != ""){
if (!CheckMacAddr(ssidCtrl3)){
return false;}
else if (ssidCtrl3.value.toLowerCase() == ssidCtrl1.value.toLowerCase()|| ssidCtrl3.value.toLowerCase() == ssidCtrl2.value.toLowerCase())
{
alert(str_pages.ntw_wlan_mode.js_mac_duplicate);
ssidCtrl3.focus();
ssidCtrl3.select();
return false;
}
else{
inputNum ++;
}}
if (ssidCtrl4.value != ""){
if (!CheckMacAddr(ssidCtrl4)){
return false;
}
else if (ssidCtrl4.value.toLowerCase() == ssidCtrl1.value.toLowerCase()||ssidCtrl4.value.toLowerCase() == ssidCtrl2.value.toLowerCase() 
|| ssidCtrl4.value.toLowerCase() == ssidCtrl3.value.toLowerCase())
{
alert(str_pages.ntw_wlan_mode.js_mac_duplicate);
ssidCtrl4.focus();
ssidCtrl4.select();
return false;
}
else{
inputNum ++;
}}
if (ssidCtrl5.value != ""){
if (!CheckMacAddr(ssidCtrl5)){
return false;
}
else if (ssidCtrl5.value.toLowerCase() == ssidCtrl1.value.toLowerCase() 
|| ssidCtrl5.value.toLowerCase() == ssidCtrl2.value.toLowerCase() 
|| ssidCtrl5.value.toLowerCase() == ssidCtrl3.value.toLowerCase()
|| ssidCtrl5.value.toLowerCase() == ssidCtrl4.value.toLowerCase())
{
alert(str_pages.ntw_wlan_mode.js_mac_duplicate);
ssidCtrl5.focus();
ssidCtrl5.select();
return false;
}
else{
inputNum ++;
}}
if (ssidCtrl6.value != ""){
if (!CheckMacAddr(ssidCtrl6)){
return false;
}
else if (ssidCtrl6.value.toLowerCase() == ssidCtrl1.value.toLowerCase() 
|| ssidCtrl6.value.toLowerCase() == ssidCtrl2.value.toLowerCase() 
|| ssidCtrl6.value.toLowerCase() == ssidCtrl3.value.toLowerCase()
|| ssidCtrl6.value.toLowerCase() == ssidCtrl4.value.toLowerCase()
|| ssidCtrl6.value.toLowerCase() == ssidCtrl5.value.toLowerCase())
{
alert(str_pages.ntw_wlan_mode.js_mac_duplicate);
ssidCtrl6.focus();
ssidCtrl6.select();
return false;
}
else{
inputNum ++;
}}
if (inputNum < 2 && father.checkIdx(idx)){
alert(str_pages.ntw_wlan_mode.js_few_mac_addr);
ssidCtrl1.focus();
ssidCtrl1.select();
return false;
}
if ((father.ps.secType == 2 || father.ps.secType == 3) && father.checkIdx(idx)){
if (!confirm(str_pages.ntw_wlan_mode.js_mksure_disable_security)){
return false;
}
else{
window.document.getElementById("secDisable").checked = true;
}}		
return true;
}}
function mode_default(idx, father)
{
this.setPara = function(){
var isApModeChecked = false;
var apModeCtrl = window.document.getElementsByName("apMode");
for (var i=0; i<apModeCtrl.length; i++){
if (apModeCtrl[i].value == father.ps.apModeChk && father.itemShow(apModeCtrl[i].value)){
isApModeChecked = true;
apModeCtrl[i].checked = true;
}}
if (!isApModeChecked){
if (0 != apModeCtrl.length){
apModeCtrl[0].checked = true;
}}
window.document.getElementsByName("secDisable").checked = false;
}
this.checkPara = function(){return true;}
}
function modeList()
{
//This value should be mode num + 1
this.count = 7;
this.htmls = apModeStr;
this.ps = new function(){
this.apModeChk = apModePara[0];
this.modes = apModePara[1];
this.staType = apModePara[2];
this.wdsDisabled = apModePara[3];
this.staSsid = apModePara[4];
this.staBssid = apModePara[5];
this.rptBssid = apModePara[6];
this.urptBssid = apModePara[7];
this.pptBssid = apModePara[8];
this.mptBssid1 = apModePara[9];
this.mptBssid2 = apModePara[10];
this.mptBssid3 = apModePara[11];
this.mptBssid4 = apModePara[12];
this.mptBssid5 = apModePara[13];
this.mptBssid6 = apModePara[14];
this.pptApMode = apModePara[15];
this.mptApMode = apModePara[16];
this.apBroadcast = apModePara[17];
this.secType = apModePara[18];
}
this.checkIdx = function(idx){
var apModeCtrl = window.document.getElementsByName("apMode");
for (var i=0; i<apModeCtrl.length; i++){
if (apModeCtrl[i].checked){break;}
}
if (idx == apModeCtrl[i].value){return true;}
else{return false;}
}
this.itemShow = function(idx)
{
return this.ps.modes.charAt(idx) == '1';
}
this.itemHtml = function(idx){
return this.htmls[idx];
}
this.item = function (item){
switch (item){
case 0:return new mode_disable(item, this);
case 1:return new mode_ap(item, this);
case 2:return new mode_clientWds(item, this);
case 3:return new mode_repeater(item, this);
case 4:return new mode_uRepeater(item, this);
case 5:return new mode_bridge(item, this);
case 6:return new mode_mBridge(item, this);
default:return new mode_default(item, this);
}}}
var mlist = new modeList();
//--></SCRIPT>
<SCRIPT language="javascript"><!--
function Dialog(url, action, init){return Dialog._geckoOpenModal(url,action,init);}
Dialog._return = null;
Dialog._modal = null;
Dialog._arguments = null;
Dialog._parentEvent = function(ev)
{
if (Dialog._modal && !Dialog._modal.closed){Dialog._modal.focus();}
};
Dialog._geckoOpenModal = function(url,action,init){
var dlg = window.open(url,"ha_dialog","width=700,height=500,scrollbars=yes,resizable=yes,toolbar=no,menubar=no,personalbar=no");
Dialog._modal = dlg;
Dialog._arguments = init;
capwin(window.parent);
for (var i=0; i<window.parent.frames.length;capwin(window.parent.frames[i++]));
Dialog._return = function(val){
if (val && action)
action(val);
relwin(window.parent);
for (var i=0; i<window.parent.frames.length; relwin(window.parent.frames[i++]));
Dialog._modal = null;
}}
function capwin(w)
{
if (document.all){
w.attachEvent("onclick",Dialog._parentEvent);
w.attachEvent("onmousedown",Dialog._parentEvent);
w.attachEvent("onfocus",Dialog._parentEvent);
}
else{
w.addEventListener("click",Dialog._parentEvent,true);
w.addEventListener("mousedown",Dialog._parentEvent,true);
w.addEventListener("focus",Dialog._parentEvent,true);
}}
function relwin(w)
{
if (document.all){
w.detachEvent("onfocus",Dialog._parentEvent);
w.detachEvent("onmousedown",Dialog._parentEvent);
w.detachEvent("onclick",Dialog._parentEvent);
}
else{
w.delEventListener("focus",Dialog._parentEvent,true);
w.delEventListener("mousedown",Dialog._parentEvent,true);
w.delEventListener("click",Dialog._parentEvent,true);
}}
function generateURL()
{
var modeSelected = -1;
var modeExist = -1;
var modeSkip = 0;
var modePos = 0;
var url = "/userRpm/popupSiteSurveyRpm.htm";
with (document.forms[0]){
for(var i=0; i<apMode.length; i++){
if (apMode[i].checked == true){
modeSelected = i;
break;
}}
while (modeExist < modeSelected){
if(apModePara[1].charAt(modePos) == '0'){modeSkip++;}
else{modeExist++;}
modePos++;
}
switch(modeSelected+modeSkip){
case 0:
case 1:
return url;
case 2:
url += "?iMAC=staBssid&iSSID=staSsid";
return url;
case 3:
url += "?iMAC=rptBssid";
return url;
case 4:
url += "?iMAC=urptBssid";
return url;
case 5:
url += "?iMAC=pptBssid";
return url;
case 6:
if (mptBssid1.value == "")
url += "?iMAC=mptBssid1";
else if (mptBssid2.value == "")
url += "?iMAC=mptBssid2";
else if (mptBssid3.value == "")
url += "?iMAC=mptBssid3";
else if (mptBssid4.value == "")
url += "?iMAC=mptBssid4";
else if (mptBssid5.value == "")
url += "?iMAC=mptBssid5";
else
url += "?iMAC=mptBssid6";
return url;
default:
return url;
}}}
function doSurvey(){Dialog (generateURL(), "", "");}
//--></SCRIPT>
</HEAD>
<BODY onLoad="setTagStr(document,'ntw_wlan_mode'); LoadHelp('WlanModeHelpRpm.htm'); resize(this);" onResize="resize(this);"><CENTER>
<FORM onsubmit="return doSubmit();" action="WlanModeRpm.htm" method="get" encType="multipart/form-data">
<TABLE id=autoWidth><TBODY>

<TR><TD class=h1 colSpan=2><span id="t_title">Wireless Mode Settings</span></TD></TR>
<TR><TD class=blue colSpan=2></TD></TR>
<SCRIPT language="javascript">
for(var i=0; i<mlist.count; i++){
if (mlist.itemShow(i))
document.write(mlist.itemHtml(i));
}
</SCRIPT>
<TR><TD></TD><TD><input name="Survey" id="survey" type="button" class="buttonBig" value="Survey" onClick="doSurvey();"></TD></TR>
<TR><TD class=blue colSpan=2></TD></TR>
<TR><TD>&nbsp;</TD><TD><INPUT class=buttonBig type=submit value=Save name=Save></TD></TR>
<TR style="display:none"><TD colSpan=2><INPUT id="secDisable" name="secDisable" type="checkbox" value="2"></TD></TR>
<TR><TD colspan=2 style="text-align:left; white-space:normal; COLOR: #696969;"><strong id="t_note">Note:</strong>&nbsp; <span id="t_msg">The current security method may be invalid after changing the wireless mode.</span></TD></TR></TABLE>
</TBODY></TABLE></FORM>
</CENTER></BODY>
<SCRIPT language="javascript">
for(var i=0; i<=mlist.count; i++){
if (mlist.itemShow(i))
mlist.item(i).setPara();}
with(document.forms[0]){
if (0==apModePara[0])
survey.disabled = true;
else
survey.disabled = false;
}	
if("101000011" == apModePara[1]){
document.getElementById('chkWds').style.display='none';}
</SCRIPT>

</HTML>
